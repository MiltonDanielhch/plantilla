---
---
<button id="logout-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition-colors cursor-pointer" style="background-color: #ef4444; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; font-weight: bold; cursor: pointer; transition: opacity 0.2s;">
    Cerrar Sesión
</button>

<script>
    import { api } from '../lib/api';
    
    const btn = document.getElementById('logout-btn') as HTMLButtonElement;
    
    if (btn) {
        btn.addEventListener('click', async () => {
            const originalText = btn.innerText;
            btn.innerText = "Cerrando...";
            btn.style.opacity = "0.7";
            btn.style.cursor = "not-allowed";
            btn.disabled = true;

            try {
                // Use the centralized api client
                await api.logout();
                
                // On success, redirect to the login page
                window.location.href = '/login/';
            } catch (e) {
                console.error("Error during logout:", e);
                // In case of an error, revert the button to its original state
                btn.innerText = originalText;
                btn.style.opacity = "1";
                btn.style.cursor = "pointer";
                btn.disabled = false;
                // Optionally, show an error message to the user
                alert('No se pudo cerrar la sesión. Inténtalo de nuevo.');
            }
        });
    }
</script>